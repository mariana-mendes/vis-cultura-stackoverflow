---
title: "Comentários e cultura"
author: Mariana Mendes e Silva
output:
  rmdformats::readthedown:
    highlight: pygments
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
library(viridis)
source(here::here("code/import_data.R"))
theme_set(theme_bw())


knitr::opts_chunk$set(tidy = FALSE,
                      fig.width = 6,
                      fig.height = 5)


```


```{r read}
dados = read_csv(
    here::here("data/participation-per-country.csv"),
    col_types = cols(
        .default = col_double(),
        site = col_character(),
        country = col_character(),
        geo = col_character(),
        four_regions = col_character(),
        eight_regions = col_character(),
        six_regions = col_character(),
        `World bank income group 2017` = col_character()
    )
) %>% 
    filter(usuarios > 200)
glimpse(dados)
```

Estamos interessados na relação entre quanto as pessoas de diferentes países comentam em questões dos outros. A proporção das pessoas do país que comentou nas questões de outros está medido na variável `comentaram_prop`. 

Considerando essa variável, queremos examinar a relação entre ela e o quão hierárquicas são as relações em um país (`PDI`). Queremos também levar em conta o quanto as pessoas daquele país têm acesso à Internet (`Internet`) e qual o tamanho da base de dados que detectamos daquele país (`usuarios`). 

## Examinando essa relação

Faça uma visualização que usa os princípios de eficácia no projeto de visualizações para facilitar as comparações que você acha que são as mais importantes para entendermos esse contexto. 

```{r}
dados %>%
    ggplot(aes(
        x = comentaram_prop,
        y = Internet,
        color = PDI,
        size = log10(usuarios)
    )) +
    geom_jitter( alpha = 0.8, height = 5)

```



* Pontos que podem ser observados:
    - Geralmente, quanto mais acesso a internet, menor o PDI;
    - O pontos aparentemente formam um padrao, que talvez seja a relação linear entre o quanto as pessoas têm acesso à Internet e a proporção de pessoas  que comentou nas questões de outros. (`Internet`x `comentaram_prop`)
    - Os pontos menores também tendem a ser mais claros (- usuários, + PDI)
    
## Outras formas de ver

Em seguida, faça 5 visualizações que usem as mesmas variáveis e também pontos, mas que sejam **menos eficazes** que a que você escolheu acima. 

1. Cores e tamanhos dos pontos muito similares.

```{r}
dados %>%
    ggplot(aes(
        x = log10(usuarios),
        y = Internet,
        color = comentaram_prop,
        size = PDI
    )) +
    geom_point( alpha = 0.8)

```



2. Cores e tamanhos dos pontos muito similares.
```{r}
dados %>%
    ggplot(aes(
        x = log10(usuarios),
        y = comentaram_prop,
        color = Internet,
        size = PDI
    )) +
    geom_point( alpha = 0.8)

```


3. Cores e tamanhos dos pontos muito similares
```{r}
dados %>%
    ggplot(aes(
        x = log10(usuarios),
        y = PDI,
        color = comentaram_prop,
        size = Internet
    )) +
    geom_point( alpha = 0.8)

```

As três visualização ficaram muito similares em relação a dificuldade de entendimento, além das cores e tamanhos, os pontos não formam nenhum padrão, curva, ou reta, o que pode dificultar na hora de relacionar as variáveis dos eixos x e y. 


4. Sem variação de cores nos pontos. 
```{r}
dados %>%
    ggplot(aes(
        x = comentaram_prop,
        y = PDI,
        color = usuarios,
        size = Internet
    )) +
    geom_point( alpha = 0.8)

```

5. Sem muita variação de cores nos pontos. 
```{r}
dados %>%
    ggplot(aes(
        x = log10(usuarios),
        y = PDI,
        color = Internet,
        size = comentaram_prop
    )) +
    geom_point( alpha = 0.8)

```

Nas visualizações 4 e 5 as cores ficaram muito próximas também. A partir dessas duas últimas vemos que a variável Internet talvez seja a pior escolha para representação em forma de cor ou tamanho, talvez porque o seus valores não sofrem tantas variações ou variações bruscas. 

## Bônus

Inclua o continente dos países (`six_regions`) na visualização.

```{r}
dados %>%
    ggplot(aes(
        x = comentaram_prop,
        y = Internet,
        color = PDI,
        size = log10(usuarios)
    )) +
    geom_jitter( alpha = 0.8, aes(shape = six_regions))

```

